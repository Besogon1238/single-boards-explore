# Добавление поддержки SPI в образ для Lichee RV Dock

В процессе работы с Lichee RV Dock у меня появилась задача сделать возможным работу с SPI-интерфейсом микроконтроллера, что стало неожиданно не самой простой задачей. На текущий момент о своих долгих попытках я решил изложить на этой странице.


## Краткая теория о самом интерфейсе

SPI (Serial Peripheral Interface) — это интерфейс для связи с периферийными устройствами, такими как датчики, преобразователи и память.

![alt text](/pictures/SPImult.png)

Его работа строится по принципу «ведущий-ведомый», где ведущий задаёт такт синхронизации (SCK). По одному проводу (MOSI) данные идут от ведущего к ведомому, а по другому (MISO) — обратно. Это позволяет передавать информацию в обе стороны одновременно. Однако важно помнить, что при каждой записи команды или данных вы всегда получите ответ такой же длины от ведомого устройства, даже если это ответ не несёт полезной информации.

Классическая схема подключения, приведенная на рисунке выше, является параллельной: все ведомые устройства совместно используют линии данных (MOSI, MISO) и тактирования (SCK). Единственным исключением является сигнал выбора ведомого (~CS), который для каждого устройства должен быть индивидуальным. На рисунке эти сигналы обозначены как SSx. Для их формирования можно использовать как специализированные выводы SPI-контроллера, так и универсальные GPIO-пины.

В случае с платой Lichee RV Dock базово предоставляется возможность подключить только одно SPI-устройство, что упрощает схему (см. рисунок ниже).


![alt text](/pictures/SPI.png)


## Постановка задачи

Отлично! Но в чем проблема?

А проблему можно увидеть, если обратиться к [распиновке](/pictures/pinout.png) или [схеме](/pictures/Scematic.pdf]) изучаемой платы.

Взглянем на распиновку:

![alt text](/pictures/pinout.png)



## Необходимые вводные


## Путь решения
